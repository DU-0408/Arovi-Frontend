{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import axios from'axios';import ReactMarkdown from'react-markdown';import Login from'./Login';import Register from'./Register';import LanguageSelector from'./LanguageSelector';import Settings from'./Settings';import{languages,getTranslation}from'./languages';import{getEffectiveDarkMode,subscribeToSystemDarkMode}from'./utils/darkMode';import'./App.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _user$full_name;const[isAuthenticated,setIsAuthenticated]=useState(false);const[isLoginLoading,setIsLoginLoading]=useState(false);const[loginError,setLoginError]=useState('');const[showRegister,setShowRegister]=useState(false);const[isRegisterLoading,setIsRegisterLoading]=useState(false);const[registerError,setRegisterError]=useState('');const[currentLanguage,setCurrentLanguage]=useState(languages[0]);// Default to English\nconst[showLanguageSelector,setShowLanguageSelector]=useState(false);const[showSettings,setShowSettings]=useState(false);const[messages,setMessages]=useState([]);const[inputText,setInputText]=useState('');const[isLoading,setIsLoading]=useState(false);const[selectedImage,setSelectedImage]=useState(null);const[showPrescriptionForm,setShowPrescriptionForm]=useState(false);const[patientAge,setPatientAge]=useState('');const[patientConditions,setPatientConditions]=useState('');const[isPrescriptionLoading,setIsPrescriptionLoading]=useState(false);const[chatSessions,setChatSessions]=useState([]);const[currentSessionId,setCurrentSessionId]=useState(null);const[user,setUser]=useState(null);const[contextMenu,setContextMenu]=useState(null);const[darkModePreference,setDarkModePreference]=useState('system');const[isDarkMode,setIsDarkMode]=useState(false);const fileInputRef=useRef(null);// Configure axios defaults and interceptors\nuseEffect(()=>{const token=localStorage.getItem('access_token');if(token){axios.defaults.headers.common['Authorization']=`Bearer ${token}`;setIsAuthenticated(true);fetchUserInfo();fetchChatSessions();}// Add response interceptor to handle 401 errors\nconst interceptor=axios.interceptors.response.use(response=>response,error=>{var _error$response;if(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===401){// Clear token and redirect to login\nlocalStorage.removeItem('access_token');localStorage.removeItem('user_info');delete axios.defaults.headers.common['Authorization'];setIsAuthenticated(false);setUser(null);setMessages([]);setChatSessions([]);setCurrentSessionId(null);}return Promise.reject(error);});// Cleanup interceptor on unmount\nreturn()=>{axios.interceptors.response.eject(interceptor);};},[]);// Initialize language - always default to English for login page\nuseEffect(()=>{if(isAuthenticated){// For authenticated users, we'll load their preference in fetchUserInfo\n// This prevents race conditions between localStorage and backend data\n}else{// For login page, always default to English\nsetCurrentLanguage(languages[0]);// English is the first language\n}},[isAuthenticated]);// Initialize dark mode\nuseEffect(()=>{if(isAuthenticated){// For authenticated users, fetch their preference from backend\nfetchUserDarkModePreference();}else{// For non-authenticated users, use system preference\nconst effectiveDarkMode=getEffectiveDarkMode('system');setIsDarkMode(effectiveDarkMode);}},[isAuthenticated]);// Subscribe to system dark mode changes\nuseEffect(()=>{if(!isAuthenticated||darkModePreference==='system'){const unsubscribe=subscribeToSystemDarkMode(isDark=>{if(!isAuthenticated||darkModePreference==='system'){setIsDarkMode(isDark);}});return unsubscribe;}},[isAuthenticated,darkModePreference]);const fetchUserInfo=async()=>{try{// For now, we'll get user info from the login response\n// In a real app, you'd have a /me endpoint\nconst userInfo=localStorage.getItem('user_info');if(userInfo){setUser(JSON.parse(userInfo));}// Fetch user's language preference from backend\ntry{const response=await axios.get('http://localhost:8000/user/language');const{language}=response.data;// Update current language based on user preference\nconst userLanguage=languages.find(lang=>lang.code===language);if(userLanguage){setCurrentLanguage(userLanguage);localStorage.setItem('user_language',language);}else{// If no language preference is set, show language selector\nsetShowLanguageSelector(true);}}catch(error){var _error$response2;console.error('Error fetching user language preference:',error);// If it's an authentication error, clear the token and redirect to login\nif(((_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.status)===401){handleLogout();return;}// Fall back to stored language preference\nconst savedLanguage=localStorage.getItem('user_language');if(savedLanguage){const language=languages.find(lang=>lang.code===savedLanguage);if(language){setCurrentLanguage(language);}else{// If no valid language preference found, show language selector\nsetShowLanguageSelector(true);}}else{// If no language preference at all, show language selector\nsetShowLanguageSelector(true);}}// Fetch user's dark mode preference from backend\nawait fetchUserDarkModePreference();}catch(error){console.error('Error fetching user info:',error);}};const fetchChatSessions=async()=>{try{const response=await axios.get('http://localhost:8000/chat/sessions');setChatSessions(response.data);}catch(error){var _error$response3;console.error('Error fetching chat sessions:',error);// If it's an authentication error, clear the token and redirect to login\nif(((_error$response3=error.response)===null||_error$response3===void 0?void 0:_error$response3.status)===401){handleLogout();return;}}};const fetchUserDarkModePreference=async()=>{try{const response=await axios.get('http://localhost:8000/user/dark-mode');const{dark_mode}=response.data;setDarkModePreference(dark_mode);const effectiveDarkMode=getEffectiveDarkMode(dark_mode);setIsDarkMode(effectiveDarkMode);}catch(error){var _error$response4;console.error('Error fetching user dark mode preference:',error);// If it's an authentication error, clear the token and redirect to login\nif(((_error$response4=error.response)===null||_error$response4===void 0?void 0:_error$response4.status)===401){handleLogout();return;}// Fall back to system preference\nsetDarkModePreference('system');const effectiveDarkMode=getEffectiveDarkMode('system');setIsDarkMode(effectiveDarkMode);}};const handleLogin=async(email,password)=>{setIsLoginLoading(true);setLoginError('');try{const formData=new FormData();formData.append('email',email);formData.append('password',password);const response=await axios.post('http://localhost:8000/auth/login',formData);const{access_token,user:userInfo}=response.data;// Store token and user info\nlocalStorage.setItem('access_token',access_token);localStorage.setItem('user_info',JSON.stringify(userInfo));// Set axios default header\naxios.defaults.headers.common['Authorization']=`Bearer ${access_token}`;setIsAuthenticated(true);setUser(userInfo);setLoginError('');// Fetch user's language preference and chat sessions\nawait fetchUserInfo();await fetchChatSessions();}catch(error){var _error$response5,_error$response5$data;console.error('Login error:',error);setLoginError(((_error$response5=error.response)===null||_error$response5===void 0?void 0:(_error$response5$data=_error$response5.data)===null||_error$response5$data===void 0?void 0:_error$response5$data.detail)||'Login failed. Please try again.');}setIsLoginLoading(false);};const handleRegister=async(email,password,fullName)=>{setIsRegisterLoading(true);setRegisterError('');try{const formData=new FormData();formData.append('email',email);formData.append('password',password);formData.append('full_name',fullName);const response=await axios.post('http://localhost:8000/auth/register',formData);const{access_token,user:userInfo}=response.data;// Store token and user info\nlocalStorage.setItem('access_token',access_token);localStorage.setItem('user_info',JSON.stringify(userInfo));// Set axios default header\naxios.defaults.headers.common['Authorization']=`Bearer ${access_token}`;setIsAuthenticated(true);setUser(userInfo);setRegisterError('');setShowRegister(false);// Fetch user's language preference and chat sessions\nawait fetchUserInfo();await fetchChatSessions();// Check if this is a first-time user (after fetching language preference)\nconst savedLanguage=localStorage.getItem('user_language');if(!savedLanguage){setShowLanguageSelector(true);}}catch(error){var _error$response6,_error$response6$data;console.error('Registration error:',error);setRegisterError(((_error$response6=error.response)===null||_error$response6===void 0?void 0:(_error$response6$data=_error$response6.data)===null||_error$response6$data===void 0?void 0:_error$response6$data.detail)||'Registration failed. Please try again.');}setIsRegisterLoading(false);};const handleLanguageSelect=async language=>{setCurrentLanguage(language);localStorage.setItem('user_language',language.code);// Save language preference to backend if user is authenticated\nif(isAuthenticated&&user){try{const formData=new FormData();formData.append('language',language.code);await axios.put('http://localhost:8000/user/language',formData);// Refresh user info to ensure language preference is updated\nawait fetchUserInfo();}catch(error){console.error('Error saving language preference:',error);}}setShowLanguageSelector(false);};const handleLanguageChange=async language=>{setCurrentLanguage(language);localStorage.setItem('user_language',language.code);// Save language preference to backend if user is authenticated\nif(isAuthenticated&&user){try{const formData=new FormData();formData.append('language',language.code);await axios.put('http://localhost:8000/user/language',formData);// Refresh user info to ensure language preference is updated\nawait fetchUserInfo();}catch(error){console.error('Error saving language preference:',error);}}};const handleLoginPageLanguageChange=language=>{// For login page, only update the current language without saving to backend\nsetCurrentLanguage(language);// Don't save to localStorage or backend for login page changes\n};const handleDarkModeToggle=async()=>{// Cycle through: system -> light -> dark -> system\nconst newPreference=darkModePreference==='system'?'light':darkModePreference==='light'?'dark':'system';setDarkModePreference(newPreference);const effectiveDarkMode=getEffectiveDarkMode(newPreference);setIsDarkMode(effectiveDarkMode);// Save to backend if user is authenticated\nif(isAuthenticated&&user){try{const formData=new FormData();formData.append('dark_mode',newPreference);await axios.put('http://localhost:8000/user/dark-mode',formData);}catch(error){console.error('Error saving dark mode preference:',error);}}};const handleSettingsClose=()=>{setShowSettings(false);};const handleEmailChange=newEmail=>{// Update user email (in a real app, this would call an API)\nif(user){const updatedUser={...user,email:newEmail};setUser(updatedUser);localStorage.setItem('user_info',JSON.stringify(updatedUser));}};const handlePasswordChange=(currentPassword,newPassword)=>{// Update password (in a real app, this would call an API)\nconsole.log('Password change requested');};// Translation helper function\nconst t=key=>getTranslation(currentLanguage.code,key);const handleLogout=()=>{localStorage.removeItem('access_token');localStorage.removeItem('user_info');delete axios.defaults.headers.common['Authorization'];setIsAuthenticated(false);setUser(null);setMessages([]);setInputText('');setSelectedImage(null);setShowPrescriptionForm(false);setChatSessions([]);setCurrentSessionId(null);};const createNewSession=async()=>{try{// Don't create a session immediately - let it be created when first message is sent\nsetCurrentSessionId(null);setMessages([]);}catch(error){console.error('Error creating new session:',error);}};const deleteSession=async sessionId=>{try{await axios.delete(`http://localhost:8000/chat/sessions/${sessionId}`);// If the deleted session was the current one, clear it\nif(sessionId===currentSessionId){setCurrentSessionId(null);setMessages([]);}// Refresh sessions list\nawait fetchChatSessions();// Close context menu\nsetContextMenu(null);}catch(error){console.error('Error deleting session:',error);}};const loadSession=async(sessionId,sessionName)=>{try{const response=await axios.get(`http://localhost:8000/chat/sessions/${sessionId}/messages`);const sessionMessages=response.data.map(msg=>({id:msg.id.toString(),text:msg.content,isUser:msg.is_user,timestamp:new Date(msg.created_at),isPrescription:msg.is_prescription}));setMessages(sessionMessages);setCurrentSessionId(sessionId);setMessages(sessionMessages);}catch(error){console.error('Error loading session:',error);}};const sendMessage=async()=>{if(!inputText.trim()&&!selectedImage)return;const userMessage={id:Date.now().toString(),text:inputText,isUser:true,timestamp:new Date(),image:selectedImage?URL.createObjectURL(selectedImage):undefined};setMessages(prev=>[...prev,userMessage]);setIsLoading(true);try{const formData=new FormData();formData.append('message',inputText);// Only send language if it's different from user's saved preference\n// The backend will use the user's saved preference as default\nformData.append('language',currentLanguage.code);if(selectedImage){formData.append('image',selectedImage);}if(currentSessionId){formData.append('session_id',currentSessionId.toString());}const response=await axios.post('http://localhost:8000/chat/',formData);const aiMessage={id:(Date.now()+1).toString(),text:response.data.response,isUser:false,timestamp:new Date(),isPrescription:response.data.is_prescription_query};setMessages(prev=>[...prev,aiMessage]);// Update session info if this is a new session\nif(response.data.session_id&&!currentSessionId){setCurrentSessionId(response.data.session_id);await fetchChatSessions();}}catch(error){console.error('Error sending message:',error);const errorMessage={id:(Date.now()+1).toString(),text:'Sorry, there was an error processing your request. Please try again.',isUser:false,timestamp:new Date()};setMessages(prev=>[...prev,errorMessage]);}finally{setIsLoading(false);setInputText('');setSelectedImage(null);}};const analyzePrescription=async()=>{if(!selectedImage)return;setIsPrescriptionLoading(true);try{const formData=new FormData();formData.append('image',selectedImage);// Only send language if it's different from user's saved preference\n// The backend will use the user's saved preference as default\nformData.append('language',currentLanguage.code);if(patientAge)formData.append('patient_age',patientAge);if(patientConditions)formData.append('patient_conditions',patientConditions);if(currentSessionId){formData.append('session_id',currentSessionId.toString());}const response=await axios.post('http://localhost:8000/prescription-analysis/',formData);const userMessage={id:Date.now().toString(),text:`Prescription Analysis Request${patientAge?` (Age: ${patientAge})`:''}${patientConditions?` (Conditions: ${patientConditions})`:''}`,isUser:true,timestamp:new Date(),image:URL.createObjectURL(selectedImage),isPrescription:true};const aiMessage={id:(Date.now()+1).toString(),text:response.data.response,isUser:false,timestamp:new Date(),isPrescription:true};setMessages(prev=>[...prev,userMessage,aiMessage]);setShowPrescriptionForm(false);setSelectedImage(null);setPatientAge('');setPatientConditions('');// Update session info if this is a new session\nif(response.data.session_id&&!currentSessionId){setCurrentSessionId(response.data.session_id);await fetchChatSessions();}}catch(error){console.error('Error analyzing prescription:',error);const errorMessage={id:(Date.now()+1).toString(),text:'Sorry, there was an error analyzing the prescription. Please try again or consult with a pharmacist.',isUser:false,timestamp:new Date(),isPrescription:true};setMessages(prev=>[...prev,errorMessage]);}finally{setIsPrescriptionLoading(false);}};const handleImageSelect=event=>{var _event$target$files;const file=(_event$target$files=event.target.files)===null||_event$target$files===void 0?void 0:_event$target$files[0];if(file){setSelectedImage(file);}};const removeSelectedImage=()=>{setSelectedImage(null);if(fileInputRef.current){fileInputRef.current.value='';}};const handleKeyPress=event=>{if(event.key==='Enter'&&!event.shiftKey){event.preventDefault();sendMessage();}};// Handle clicking outside context menu to close it\nuseEffect(()=>{const handleClickOutside=()=>{setContextMenu(null);};if(contextMenu){document.addEventListener('click',handleClickOutside);return()=>{document.removeEventListener('click',handleClickOutside);};}},[contextMenu]);return/*#__PURE__*/_jsxs(\"div\",{className:`App ${isDarkMode?'dark-mode':''}`,children:[!isAuthenticated?/*#__PURE__*/_jsx(\"div\",{className:\"login-container\",children:showRegister?/*#__PURE__*/_jsx(Register,{onRegister:handleRegister,isLoading:isRegisterLoading,error:registerError,onSwitchToLogin:()=>setShowRegister(false),currentLanguage:currentLanguage,t:t,onLanguageChange:handleLoginPageLanguageChange}):/*#__PURE__*/_jsx(Login,{onLogin:handleLogin,isLoading:isLoginLoading,error:loginError,onSwitchToRegister:()=>setShowRegister(true),currentLanguage:currentLanguage,t:t,onLanguageChange:handleLoginPageLanguageChange})}):/*#__PURE__*/_jsxs(\"div\",{className:\"chatgpt-layout\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sidebar-header\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:createNewSession,className:\"new-chat-btn\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"+\"}),\" \",t('newChat')]})}),/*#__PURE__*/_jsx(\"div\",{className:\"conversations-list\",children:chatSessions.map(session=>/*#__PURE__*/_jsxs(\"div\",{onClick:()=>loadSession(session.id,session.session_name),onContextMenu:e=>{e.preventDefault();setContextMenu({x:e.clientX,y:e.clientY,sessionId:session.id});},className:`conversation-item ${session.id===currentSessionId?'active':''}`,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"conversation-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"conversation-title\",children:session.session_name}),/*#__PURE__*/_jsxs(\"div\",{className:\"conversation-meta\",children:[session.message_count,\" \",t('messages')]})]}),session.id===currentSessionId&&/*#__PURE__*/_jsx(\"div\",{className:\"active-indicator\",children:\"\\u25CF\"})]},session.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar-footer\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"user-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-avatar\",children:(user===null||user===void 0?void 0:(_user$full_name=user.full_name)===null||_user$full_name===void 0?void 0:_user$full_name.charAt(0))||'U'}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-details\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-name\",children:(user===null||user===void 0?void 0:user.full_name)||'User'}),/*#__PURE__*/_jsx(\"div\",{className:\"user-email\",children:user===null||user===void 0?void 0:user.email})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar-actions\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowLanguageSelector(true),className:\"sidebar-action-btn\",children:[\"\\uD83C\\uDF0D \",currentLanguage.nativeName]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowSettings(true),className:\"sidebar-action-btn\",children:[\"\\u2699\\uFE0F \",t('settings')]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"sidebar-action-btn logout\",children:t('logout')})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"main-chat\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-header-content\",children:[/*#__PURE__*/_jsx(\"h1\",{children:t('pediatricAIAssistant')}),/*#__PURE__*/_jsx(\"p\",{children:t('askMeAboutHealth')})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-header-actions\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowPrescriptionForm(!showPrescriptionForm),className:`header-action-btn ${showPrescriptionForm?'active':''}`,children:t('prescriptionAnalysis')})})]}),showPrescriptionForm&&/*#__PURE__*/_jsxs(\"div\",{className:\"prescription-form\",children:[/*#__PURE__*/_jsx(\"h3\",{children:t('prescriptionAnalysis')}),/*#__PURE__*/_jsxs(\"div\",{className:\"prescription-inputs\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:t('patientAge')}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:patientAge,onChange:e=>setPatientAge(e.target.value),placeholder:t('patientAgePlaceholder')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:t('medicalConditions')}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:patientConditions,onChange:e=>setPatientConditions(e.target.value),placeholder:t('medicalConditionsPlaceholder')})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"prescription-actions\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",ref:fileInputRef,onChange:handleImageSelect,accept:\"image/*\",style:{display:'none'}}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{var _fileInputRef$current;return(_fileInputRef$current=fileInputRef.current)===null||_fileInputRef$current===void 0?void 0:_fileInputRef$current.click();},className:\"upload-btn\",children:t('uploadPrescription')}),selectedImage&&/*#__PURE__*/_jsx(\"button\",{onClick:analyzePrescription,disabled:isPrescriptionLoading,className:\"analyze-btn\",children:isPrescriptionLoading?t('analyzing'):t('analyzePrescription')})]}),selectedImage&&/*#__PURE__*/_jsxs(\"div\",{className:\"selected-image\",children:[/*#__PURE__*/_jsx(\"img\",{src:URL.createObjectURL(selectedImage),alt:\"Selected\",className:\"preview-image\"}),/*#__PURE__*/_jsx(\"button\",{onClick:removeSelectedImage,className:\"remove-btn\",children:\"\\u2715\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"messages-container\",children:[messages.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"empty-state-icon\",children:\"\\uD83D\\uDC68\\u200D\\u2695\\uFE0F\"}),/*#__PURE__*/_jsx(\"h2\",{children:t('welcome')}),/*#__PURE__*/_jsx(\"p\",{children:t('emptyStateMessage')})]}):messages.map(message=>/*#__PURE__*/_jsxs(\"div\",{className:`message ${message.isUser?'user':'ai'}`,children:[/*#__PURE__*/_jsx(\"div\",{className:\"message-avatar\",children:message.isUser?'ðŸ‘¤':'ðŸ‘¨â€âš•ï¸'}),/*#__PURE__*/_jsxs(\"div\",{className:\"message-content\",children:[message.isUser?/*#__PURE__*/_jsx(\"div\",{className:\"user-message\",children:message.text}):/*#__PURE__*/_jsx(\"div\",{className:\"ai-message\",children:/*#__PURE__*/_jsx(ReactMarkdown,{components:{h1:_ref=>{let{node,children,...props}=_ref;return/*#__PURE__*/_jsx(\"h1\",{style:{fontSize:'1.2em',margin:'8px 0'},...props,children:children});},h2:_ref2=>{let{node,children,...props}=_ref2;return/*#__PURE__*/_jsx(\"h2\",{style:{fontSize:'1.1em',margin:'8px 0'},...props,children:children});},h3:_ref3=>{let{node,children,...props}=_ref3;return/*#__PURE__*/_jsx(\"h3\",{style:{fontSize:'1em',margin:'6px 0'},...props,children:children});},p:_ref4=>{let{node,...props}=_ref4;return/*#__PURE__*/_jsx(\"p\",{style:{margin:'4px 0'},...props});},ul:_ref5=>{let{node,...props}=_ref5;return/*#__PURE__*/_jsx(\"ul\",{style:{margin:'8px 0',paddingLeft:'20px'},...props});},ol:_ref6=>{let{node,...props}=_ref6;return/*#__PURE__*/_jsx(\"ol\",{style:{margin:'8px 0',paddingLeft:'20px'},...props});},li:_ref7=>{let{node,...props}=_ref7;return/*#__PURE__*/_jsx(\"li\",{style:{margin:'2px 0'},...props});},strong:_ref8=>{let{node,...props}=_ref8;return/*#__PURE__*/_jsx(\"strong\",{style:{fontWeight:'bold'},...props});},em:_ref9=>{let{node,...props}=_ref9;return/*#__PURE__*/_jsx(\"em\",{style:{fontStyle:'italic'},...props});},blockquote:_ref0=>{let{node,...props}=_ref0;return/*#__PURE__*/_jsx(\"blockquote\",{style:{borderLeft:'3px solid #667eea',paddingLeft:'12px',margin:'8px 0',fontStyle:'italic'},...props});},code:_ref1=>{let{node,...props}=_ref1;return/*#__PURE__*/_jsx(\"code\",{style:{backgroundColor:'rgba(102, 126, 234, 0.1)',padding:'2px 4px',borderRadius:'3px',fontFamily:'monospace'},...props});}},children:message.text})}),message.image&&/*#__PURE__*/_jsx(\"img\",{src:message.image,alt:\"Uploaded\",className:\"message-image\"})]})]},message.id)),isLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"message ai\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"message-avatar\",children:\"\\uD83D\\uDC68\\u200D\\u2695\\uFE0F\"}),/*#__PURE__*/_jsx(\"div\",{className:\"message-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"ai-message\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"typing-indicator\",children:[/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"span\",{})]})})})]}),isPrescriptionLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"message ai\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"message-avatar\",children:\"\\uD83D\\uDC68\\u200D\\u2695\\uFE0F\"}),/*#__PURE__*/_jsx(\"div\",{className:\"message-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"ai-message\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"typing-indicator\",children:[/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"span\",{})]})})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-wrapper\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:inputText,onChange:e=>setInputText(e.target.value),onKeyPress:handleKeyPress,placeholder:t('chatPlaceholder'),className:\"text-input\",rows:1}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-actions\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",ref:fileInputRef,onChange:handleImageSelect,accept:\"image/*\",style:{display:'none'}}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{var _fileInputRef$current2;return(_fileInputRef$current2=fileInputRef.current)===null||_fileInputRef$current2===void 0?void 0:_fileInputRef$current2.click();},className:\"upload-btn\",type:\"button\",children:\"\\uD83D\\uDCF7\"}),/*#__PURE__*/_jsx(\"button\",{onClick:sendMessage,disabled:isLoading||!inputText.trim()&&!selectedImage,className:\"send-btn\",children:t('send')})]})]}),selectedImage&&!showPrescriptionForm&&/*#__PURE__*/_jsxs(\"div\",{className:\"selected-image\",children:[/*#__PURE__*/_jsx(\"img\",{src:URL.createObjectURL(selectedImage),alt:\"Selected\",className:\"preview-image\"}),/*#__PURE__*/_jsx(\"button\",{onClick:removeSelectedImage,className:\"remove-image-btn\",children:\"\\u2715\"})]})]})]})]}),contextMenu&&/*#__PURE__*/_jsx(\"div\",{className:\"context-menu\",style:{position:'fixed',top:contextMenu.y,left:contextMenu.x,zIndex:1000},onClick:e=>e.stopPropagation(),children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>contextMenu.sessionId&&deleteSession(contextMenu.sessionId),className:\"context-menu-item delete\",children:\"\\uD83D\\uDDD1\\uFE0F Delete Chat\"})}),/*#__PURE__*/_jsx(LanguageSelector,{onLanguageSelect:handleLanguageSelect,isVisible:showLanguageSelector}),/*#__PURE__*/_jsx(Settings,{isVisible:showSettings,onClose:handleSettingsClose,currentLanguage:currentLanguage,currentEmail:(user===null||user===void 0?void 0:user.email)||'',onEmailChange:handleEmailChange,onPasswordChange:handlePasswordChange,darkModePreference:darkModePreference,isDarkMode:isDarkMode,onDarkModeToggle:handleDarkModeToggle})]});}export default App;","map":{"version":3,"names":["React","useState","useRef","useEffect","axios","ReactMarkdown","Login","Register","LanguageSelector","Settings","languages","getTranslation","getEffectiveDarkMode","subscribeToSystemDarkMode","jsx","_jsx","jsxs","_jsxs","App","_user$full_name","isAuthenticated","setIsAuthenticated","isLoginLoading","setIsLoginLoading","loginError","setLoginError","showRegister","setShowRegister","isRegisterLoading","setIsRegisterLoading","registerError","setRegisterError","currentLanguage","setCurrentLanguage","showLanguageSelector","setShowLanguageSelector","showSettings","setShowSettings","messages","setMessages","inputText","setInputText","isLoading","setIsLoading","selectedImage","setSelectedImage","showPrescriptionForm","setShowPrescriptionForm","patientAge","setPatientAge","patientConditions","setPatientConditions","isPrescriptionLoading","setIsPrescriptionLoading","chatSessions","setChatSessions","currentSessionId","setCurrentSessionId","user","setUser","contextMenu","setContextMenu","darkModePreference","setDarkModePreference","isDarkMode","setIsDarkMode","fileInputRef","token","localStorage","getItem","defaults","headers","common","fetchUserInfo","fetchChatSessions","interceptor","interceptors","response","use","error","_error$response","status","removeItem","Promise","reject","eject","fetchUserDarkModePreference","effectiveDarkMode","unsubscribe","isDark","userInfo","JSON","parse","get","language","data","userLanguage","find","lang","code","setItem","_error$response2","console","handleLogout","savedLanguage","_error$response3","dark_mode","_error$response4","handleLogin","email","password","formData","FormData","append","post","access_token","stringify","_error$response5","_error$response5$data","detail","handleRegister","fullName","_error$response6","_error$response6$data","handleLanguageSelect","put","handleLanguageChange","handleLoginPageLanguageChange","handleDarkModeToggle","newPreference","handleSettingsClose","handleEmailChange","newEmail","updatedUser","handlePasswordChange","currentPassword","newPassword","log","t","key","createNewSession","deleteSession","sessionId","delete","loadSession","sessionName","sessionMessages","map","msg","id","toString","text","content","isUser","is_user","timestamp","Date","created_at","isPrescription","is_prescription","sendMessage","trim","userMessage","now","image","URL","createObjectURL","undefined","prev","aiMessage","is_prescription_query","session_id","errorMessage","analyzePrescription","handleImageSelect","event","_event$target$files","file","target","files","removeSelectedImage","current","value","handleKeyPress","shiftKey","preventDefault","handleClickOutside","document","addEventListener","removeEventListener","className","children","onRegister","onSwitchToLogin","onLanguageChange","onLogin","onSwitchToRegister","onClick","session","session_name","onContextMenu","e","x","clientX","y","clientY","message_count","full_name","charAt","nativeName","type","onChange","placeholder","ref","accept","style","display","_fileInputRef$current","click","disabled","src","alt","length","message","components","h1","_ref","node","props","fontSize","margin","h2","_ref2","h3","_ref3","p","_ref4","ul","_ref5","paddingLeft","ol","_ref6","li","_ref7","strong","_ref8","fontWeight","em","_ref9","fontStyle","blockquote","_ref0","borderLeft","_ref1","backgroundColor","padding","borderRadius","fontFamily","onKeyPress","rows","_fileInputRef$current2","position","top","left","zIndex","stopPropagation","onLanguageSelect","isVisible","onClose","currentEmail","onEmailChange","onPasswordChange","onDarkModeToggle"],"sources":["/Users/devanshupadhyay/PDs/IBM/frontend/src/App.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport axios from 'axios';\nimport ReactMarkdown from 'react-markdown';\nimport Login from './Login';\nimport Register from './Register';\nimport LanguageSelector from './LanguageSelector';\nimport Settings from './Settings';\nimport { languages, Language, getTranslation } from './languages';\nimport { DarkModePreference, getEffectiveDarkMode, subscribeToSystemDarkMode } from './utils/darkMode';\nimport './App.css';\n\ninterface Message {\n  id: string;\n  text: string;\n  isUser: boolean;\n  timestamp: Date;\n  image?: string;\n  isPrescription?: boolean;\n}\n\ninterface ChatSession {\n  id: number;\n  session_name: string;\n  created_at: string;\n  updated_at: string;\n  message_count: number;\n}\n\ninterface User {\n  id: number;\n  email: string;\n  full_name: string;\n}\n\nfunction App() {\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isLoginLoading, setIsLoginLoading] = useState(false);\n  const [loginError, setLoginError] = useState('');\n  const [showRegister, setShowRegister] = useState(false);\n  const [isRegisterLoading, setIsRegisterLoading] = useState(false);\n  const [registerError, setRegisterError] = useState('');\n  const [currentLanguage, setCurrentLanguage] = useState<Language>(languages[0]); // Default to English\n  const [showLanguageSelector, setShowLanguageSelector] = useState(false);\n  const [showSettings, setShowSettings] = useState(false);\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [inputText, setInputText] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [selectedImage, setSelectedImage] = useState<File | null>(null);\n  const [showPrescriptionForm, setShowPrescriptionForm] = useState(false);\n  const [patientAge, setPatientAge] = useState('');\n  const [patientConditions, setPatientConditions] = useState('');\n  const [isPrescriptionLoading, setIsPrescriptionLoading] = useState(false);\n  const [chatSessions, setChatSessions] = useState<ChatSession[]>([]);\n  const [currentSessionId, setCurrentSessionId] = useState<number | null>(null);\n  const [user, setUser] = useState<User | null>(null);\n  const [contextMenu, setContextMenu] = useState<{ x: number; y: number; sessionId: number | null } | null>(null);\n  const [darkModePreference, setDarkModePreference] = useState<DarkModePreference>('system');\n  const [isDarkMode, setIsDarkMode] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Configure axios defaults and interceptors\n  useEffect(() => {\n    const token = localStorage.getItem('access_token');\n    if (token) {\n      axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      setIsAuthenticated(true);\n      fetchUserInfo();\n      fetchChatSessions();\n    }\n    \n    // Add response interceptor to handle 401 errors\n    const interceptor = axios.interceptors.response.use(\n      (response) => response,\n      (error) => {\n        if (error.response?.status === 401) {\n          // Clear token and redirect to login\n          localStorage.removeItem('access_token');\n          localStorage.removeItem('user_info');\n          delete axios.defaults.headers.common['Authorization'];\n          setIsAuthenticated(false);\n          setUser(null);\n          setMessages([]);\n          setChatSessions([]);\n          setCurrentSessionId(null);\n        }\n        return Promise.reject(error);\n      }\n    );\n    \n    // Cleanup interceptor on unmount\n    return () => {\n      axios.interceptors.response.eject(interceptor);\n    };\n  }, []);\n\n  // Initialize language - always default to English for login page\n  useEffect(() => {\n    if (isAuthenticated) {\n      // For authenticated users, we'll load their preference in fetchUserInfo\n      // This prevents race conditions between localStorage and backend data\n    } else {\n      // For login page, always default to English\n      setCurrentLanguage(languages[0]); // English is the first language\n    }\n  }, [isAuthenticated]);\n\n  // Initialize dark mode\n  useEffect(() => {\n    if (isAuthenticated) {\n      // For authenticated users, fetch their preference from backend\n      fetchUserDarkModePreference();\n    } else {\n      // For non-authenticated users, use system preference\n      const effectiveDarkMode = getEffectiveDarkMode('system');\n      setIsDarkMode(effectiveDarkMode);\n    }\n  }, [isAuthenticated]);\n\n  // Subscribe to system dark mode changes\n  useEffect(() => {\n    if (!isAuthenticated || darkModePreference === 'system') {\n      const unsubscribe = subscribeToSystemDarkMode((isDark) => {\n        if (!isAuthenticated || darkModePreference === 'system') {\n          setIsDarkMode(isDark);\n        }\n      });\n      \n      return unsubscribe;\n    }\n  }, [isAuthenticated, darkModePreference]);\n\n  const fetchUserInfo = async () => {\n    try {\n      // For now, we'll get user info from the login response\n      // In a real app, you'd have a /me endpoint\n      const userInfo = localStorage.getItem('user_info');\n      if (userInfo) {\n        setUser(JSON.parse(userInfo));\n      }\n      \n      // Fetch user's language preference from backend\n      try {\n        const response = await axios.get('http://localhost:8000/user/language');\n        const { language } = response.data;\n        \n        // Update current language based on user preference\n        const userLanguage = languages.find(lang => lang.code === language);\n        if (userLanguage) {\n          setCurrentLanguage(userLanguage);\n          localStorage.setItem('user_language', language);\n        } else {\n          // If no language preference is set, show language selector\n          setShowLanguageSelector(true);\n        }\n      } catch (error: any) {\n        console.error('Error fetching user language preference:', error);\n        \n        // If it's an authentication error, clear the token and redirect to login\n        if (error.response?.status === 401) {\n          handleLogout();\n          return;\n        }\n        \n        // Fall back to stored language preference\n        const savedLanguage = localStorage.getItem('user_language');\n        if (savedLanguage) {\n          const language = languages.find(lang => lang.code === savedLanguage);\n          if (language) {\n            setCurrentLanguage(language);\n          } else {\n            // If no valid language preference found, show language selector\n            setShowLanguageSelector(true);\n          }\n        } else {\n          // If no language preference at all, show language selector\n          setShowLanguageSelector(true);\n        }\n      }\n      \n      // Fetch user's dark mode preference from backend\n      await fetchUserDarkModePreference();\n    } catch (error) {\n      console.error('Error fetching user info:', error);\n    }\n  };\n\n  const fetchChatSessions = async () => {\n    try {\n      const response = await axios.get('http://localhost:8000/chat/sessions');\n      setChatSessions(response.data);\n    } catch (error: any) {\n      console.error('Error fetching chat sessions:', error);\n      \n      // If it's an authentication error, clear the token and redirect to login\n      if (error.response?.status === 401) {\n        handleLogout();\n        return;\n      }\n    }\n  };\n\n  const fetchUserDarkModePreference = async () => {\n    try {\n      const response = await axios.get('http://localhost:8000/user/dark-mode');\n      const { dark_mode } = response.data;\n      \n      setDarkModePreference(dark_mode as DarkModePreference);\n      const effectiveDarkMode = getEffectiveDarkMode(dark_mode as DarkModePreference);\n      setIsDarkMode(effectiveDarkMode);\n    } catch (error: any) {\n      console.error('Error fetching user dark mode preference:', error);\n      \n      // If it's an authentication error, clear the token and redirect to login\n      if (error.response?.status === 401) {\n        handleLogout();\n        return;\n      }\n      \n      // Fall back to system preference\n      setDarkModePreference('system');\n      const effectiveDarkMode = getEffectiveDarkMode('system');\n      setIsDarkMode(effectiveDarkMode);\n    }\n  };\n\n  const handleLogin = async (email: string, password: string) => {\n    setIsLoginLoading(true);\n    setLoginError('');\n    \n    try {\n      const formData = new FormData();\n      formData.append('email', email);\n      formData.append('password', password);\n\n      const response = await axios.post('http://localhost:8000/auth/login', formData);\n      \n      const { access_token, user: userInfo } = response.data;\n      \n      // Store token and user info\n      localStorage.setItem('access_token', access_token);\n      localStorage.setItem('user_info', JSON.stringify(userInfo));\n      \n      // Set axios default header\n      axios.defaults.headers.common['Authorization'] = `Bearer ${access_token}`;\n      \n      setIsAuthenticated(true);\n      setUser(userInfo);\n      setLoginError('');\n      \n      // Fetch user's language preference and chat sessions\n      await fetchUserInfo();\n      await fetchChatSessions();\n      \n    } catch (error: any) {\n      console.error('Login error:', error);\n      setLoginError(error.response?.data?.detail || 'Login failed. Please try again.');\n    }\n    \n    setIsLoginLoading(false);\n  };\n\n  const handleRegister = async (email: string, password: string, fullName: string) => {\n    setIsRegisterLoading(true);\n    setRegisterError('');\n    \n    try {\n      const formData = new FormData();\n      formData.append('email', email);\n      formData.append('password', password);\n      formData.append('full_name', fullName);\n\n      const response = await axios.post('http://localhost:8000/auth/register', formData);\n      \n      const { access_token, user: userInfo } = response.data;\n      \n      // Store token and user info\n      localStorage.setItem('access_token', access_token);\n      localStorage.setItem('user_info', JSON.stringify(userInfo));\n      \n      // Set axios default header\n      axios.defaults.headers.common['Authorization'] = `Bearer ${access_token}`;\n      \n      setIsAuthenticated(true);\n      setUser(userInfo);\n      setRegisterError('');\n      setShowRegister(false);\n      \n      // Fetch user's language preference and chat sessions\n      await fetchUserInfo();\n      await fetchChatSessions();\n      \n      // Check if this is a first-time user (after fetching language preference)\n      const savedLanguage = localStorage.getItem('user_language');\n      if (!savedLanguage) {\n        setShowLanguageSelector(true);\n      }\n      \n    } catch (error: any) {\n      console.error('Registration error:', error);\n      setRegisterError(error.response?.data?.detail || 'Registration failed. Please try again.');\n    }\n    \n    setIsRegisterLoading(false);\n  };\n\n  const handleLanguageSelect = async (language: Language) => {\n    setCurrentLanguage(language);\n    localStorage.setItem('user_language', language.code);\n    \n    // Save language preference to backend if user is authenticated\n    if (isAuthenticated && user) {\n      try {\n        const formData = new FormData();\n        formData.append('language', language.code);\n        await axios.put('http://localhost:8000/user/language', formData);\n        \n        // Refresh user info to ensure language preference is updated\n        await fetchUserInfo();\n      } catch (error) {\n        console.error('Error saving language preference:', error);\n      }\n    }\n    \n    setShowLanguageSelector(false);\n  };\n\n  const handleLanguageChange = async (language: Language) => {\n    setCurrentLanguage(language);\n    localStorage.setItem('user_language', language.code);\n    \n    // Save language preference to backend if user is authenticated\n    if (isAuthenticated && user) {\n      try {\n        const formData = new FormData();\n        formData.append('language', language.code);\n        await axios.put('http://localhost:8000/user/language', formData);\n        \n        // Refresh user info to ensure language preference is updated\n        await fetchUserInfo();\n      } catch (error) {\n        console.error('Error saving language preference:', error);\n      }\n    }\n  };\n\n  const handleLoginPageLanguageChange = (language: Language) => {\n    // For login page, only update the current language without saving to backend\n    setCurrentLanguage(language);\n    // Don't save to localStorage or backend for login page changes\n  };\n\n  const handleDarkModeToggle = async () => {\n    // Cycle through: system -> light -> dark -> system\n    const newPreference: DarkModePreference = \n      darkModePreference === 'system' ? 'light' :\n      darkModePreference === 'light' ? 'dark' : 'system';\n    \n    setDarkModePreference(newPreference);\n    const effectiveDarkMode = getEffectiveDarkMode(newPreference);\n    setIsDarkMode(effectiveDarkMode);\n    \n    // Save to backend if user is authenticated\n    if (isAuthenticated && user) {\n      try {\n        const formData = new FormData();\n        formData.append('dark_mode', newPreference);\n        await axios.put('http://localhost:8000/user/dark-mode', formData);\n      } catch (error) {\n        console.error('Error saving dark mode preference:', error);\n      }\n    }\n  };\n\n  const handleSettingsClose = () => {\n    setShowSettings(false);\n  };\n\n  const handleEmailChange = (newEmail: string) => {\n    // Update user email (in a real app, this would call an API)\n    if (user) {\n      const updatedUser = { ...user, email: newEmail };\n      setUser(updatedUser);\n      localStorage.setItem('user_info', JSON.stringify(updatedUser));\n    }\n  };\n\n  const handlePasswordChange = (currentPassword: string, newPassword: string) => {\n    // Update password (in a real app, this would call an API)\n    console.log('Password change requested');\n  };\n\n  // Translation helper function\n  const t = (key: string) => getTranslation(currentLanguage.code, key);\n\n  const handleLogout = () => {\n    localStorage.removeItem('access_token');\n    localStorage.removeItem('user_info');\n    delete axios.defaults.headers.common['Authorization'];\n    \n    setIsAuthenticated(false);\n    setUser(null);\n    setMessages([]);\n    setInputText('');\n    setSelectedImage(null);\n    setShowPrescriptionForm(false);\n    setChatSessions([]);\n    setCurrentSessionId(null);\n  };\n\n  const createNewSession = async () => {\n    try {\n      // Don't create a session immediately - let it be created when first message is sent\n      setCurrentSessionId(null);\n      setMessages([]);\n      \n    } catch (error) {\n      console.error('Error creating new session:', error);\n    }\n  };\n\n  const deleteSession = async (sessionId: number) => {\n    try {\n      await axios.delete(`http://localhost:8000/chat/sessions/${sessionId}`);\n      \n      // If the deleted session was the current one, clear it\n      if (sessionId === currentSessionId) {\n        setCurrentSessionId(null);\n        setMessages([]);\n      }\n      \n      // Refresh sessions list\n      await fetchChatSessions();\n      \n      // Close context menu\n      setContextMenu(null);\n      \n    } catch (error) {\n      console.error('Error deleting session:', error);\n    }\n  };\n\n  const loadSession = async (sessionId: number, sessionName: string) => {\n    try {\n      const response = await axios.get(`http://localhost:8000/chat/sessions/${sessionId}/messages`);\n      const sessionMessages = response.data.map((msg: any) => ({\n        id: msg.id.toString(),\n        text: msg.content,\n        isUser: msg.is_user,\n        timestamp: new Date(msg.created_at),\n        isPrescription: msg.is_prescription\n      }));\n      \n      setMessages(sessionMessages);\n      setCurrentSessionId(sessionId);\n      setMessages(sessionMessages);\n      \n    } catch (error) {\n      console.error('Error loading session:', error);\n    }\n  };\n\n  const sendMessage = async () => {\n    if (!inputText.trim() && !selectedImage) return;\n\n    const userMessage: Message = {\n      id: Date.now().toString(),\n      text: inputText,\n      isUser: true,\n      timestamp: new Date(),\n      image: selectedImage ? URL.createObjectURL(selectedImage) : undefined\n    };\n\n    setMessages(prev => [...prev, userMessage]);\n    setIsLoading(true);\n\n    try {\n      const formData = new FormData();\n      formData.append('message', inputText);\n      // Only send language if it's different from user's saved preference\n      // The backend will use the user's saved preference as default\n      formData.append('language', currentLanguage.code);\n      if (selectedImage) {\n        formData.append('image', selectedImage);\n      }\n      if (currentSessionId) {\n        formData.append('session_id', currentSessionId.toString());\n      }\n\n      const response = await axios.post('http://localhost:8000/chat/', formData);\n\n      const aiMessage: Message = {\n        id: (Date.now() + 1).toString(),\n        text: response.data.response,\n        isUser: false,\n        timestamp: new Date(),\n        isPrescription: response.data.is_prescription_query\n      };\n\n      setMessages(prev => [...prev, aiMessage]);\n      \n      // Update session info if this is a new session\n      if (response.data.session_id && !currentSessionId) {\n        setCurrentSessionId(response.data.session_id);\n        await fetchChatSessions();\n      }\n      \n    } catch (error) {\n      console.error('Error sending message:', error);\n      const errorMessage: Message = {\n        id: (Date.now() + 1).toString(),\n        text: 'Sorry, there was an error processing your request. Please try again.',\n        isUser: false,\n        timestamp: new Date(),\n      };\n      setMessages(prev => [...prev, errorMessage]);\n    } finally {\n      setIsLoading(false);\n      setInputText('');\n      setSelectedImage(null);\n    }\n  };\n\n  const analyzePrescription = async () => {\n    if (!selectedImage) return;\n\n    setIsPrescriptionLoading(true);\n\n    try {\n      const formData = new FormData();\n      formData.append('image', selectedImage);\n      // Only send language if it's different from user's saved preference\n      // The backend will use the user's saved preference as default\n      formData.append('language', currentLanguage.code);\n      if (patientAge) formData.append('patient_age', patientAge);\n      if (patientConditions) formData.append('patient_conditions', patientConditions);\n      if (currentSessionId) {\n        formData.append('session_id', currentSessionId.toString());\n      }\n\n      const response = await axios.post('http://localhost:8000/prescription-analysis/', formData);\n\n      const userMessage: Message = {\n        id: Date.now().toString(),\n        text: `Prescription Analysis Request${patientAge ? ` (Age: ${patientAge})` : ''}${patientConditions ? ` (Conditions: ${patientConditions})` : ''}`,\n        isUser: true,\n        timestamp: new Date(),\n        image: URL.createObjectURL(selectedImage),\n        isPrescription: true\n      };\n\n      const aiMessage: Message = {\n        id: (Date.now() + 1).toString(),\n        text: response.data.response,\n        isUser: false,\n        timestamp: new Date(),\n        isPrescription: true\n      };\n\n      setMessages(prev => [...prev, userMessage, aiMessage]);\n      setShowPrescriptionForm(false);\n      setSelectedImage(null);\n      setPatientAge('');\n      setPatientConditions('');\n      \n      // Update session info if this is a new session\n      if (response.data.session_id && !currentSessionId) {\n        setCurrentSessionId(response.data.session_id);\n        await fetchChatSessions();\n      }\n      \n    } catch (error) {\n      console.error('Error analyzing prescription:', error);\n      const errorMessage: Message = {\n        id: (Date.now() + 1).toString(),\n        text: 'Sorry, there was an error analyzing the prescription. Please try again or consult with a pharmacist.',\n        isUser: false,\n        timestamp: new Date(),\n        isPrescription: true\n      };\n      setMessages(prev => [...prev, errorMessage]);\n    } finally {\n      setIsPrescriptionLoading(false);\n    }\n  };\n\n  const handleImageSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      setSelectedImage(file);\n    }\n  };\n\n  const removeSelectedImage = () => {\n    setSelectedImage(null);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  const handleKeyPress = (event: React.KeyboardEvent) => {\n    if (event.key === 'Enter' && !event.shiftKey) {\n      event.preventDefault();\n      sendMessage();\n    }\n  };\n\n  // Handle clicking outside context menu to close it\n  useEffect(() => {\n    const handleClickOutside = () => {\n      setContextMenu(null);\n    };\n\n    if (contextMenu) {\n      document.addEventListener('click', handleClickOutside);\n      return () => {\n        document.removeEventListener('click', handleClickOutside);\n      };\n    }\n  }, [contextMenu]);\n\n  return (\n    <div className={`App ${isDarkMode ? 'dark-mode' : ''}`}>\n      {!isAuthenticated ? (\n        <div className=\"login-container\">\n          {showRegister ? (\n            <Register \n              onRegister={handleRegister}\n              isLoading={isRegisterLoading}\n              error={registerError}\n              onSwitchToLogin={() => setShowRegister(false)}\n              currentLanguage={currentLanguage}\n              t={t}\n              onLanguageChange={handleLoginPageLanguageChange}\n            />\n          ) : (\n            <Login \n              onLogin={handleLogin}\n              isLoading={isLoginLoading}\n              error={loginError}\n              onSwitchToRegister={() => setShowRegister(true)}\n              currentLanguage={currentLanguage}\n              t={t}\n              onLanguageChange={handleLoginPageLanguageChange}\n            />\n          )}\n        </div>\n      ) : (\n        <div className=\"chatgpt-layout\">\n          {/* Sidebar */}\n          <div className=\"sidebar\">\n            <div className=\"sidebar-header\">\n              <button \n                onClick={createNewSession}\n                className=\"new-chat-btn\"\n              >\n                <span>+</span> {t('newChat')}\n              </button>\n            </div>\n            \n            <div className=\"conversations-list\">\n              {chatSessions.map((session) => (\n                <div \n                  key={session.id}\n                  onClick={() => loadSession(session.id, session.session_name)}\n                  onContextMenu={(e) => {\n                    e.preventDefault();\n                    setContextMenu({\n                      x: e.clientX,\n                      y: e.clientY,\n                      sessionId: session.id\n                    });\n                  }}\n                  className={`conversation-item ${session.id === currentSessionId ? 'active' : ''}`}\n                >\n                  <div className=\"conversation-content\">\n                    <div className=\"conversation-title\">\n                      {session.session_name}\n                    </div>\n                    <div className=\"conversation-meta\">\n                      {session.message_count} {t('messages')}\n                    </div>\n                  </div>\n                  {session.id === currentSessionId && (\n                    <div className=\"active-indicator\">â—</div>\n                  )}\n                </div>\n              ))}\n            </div>\n            \n            <div className=\"sidebar-footer\">\n              <div className=\"user-info\">\n                <div className=\"user-avatar\">\n                  {user?.full_name?.charAt(0) || 'U'}\n                </div>\n                <div className=\"user-details\">\n                  <div className=\"user-name\">{user?.full_name || 'User'}</div>\n                  <div className=\"user-email\">{user?.email}</div>\n                </div>\n              </div>\n              \n              <div className=\"sidebar-actions\">\n                <button \n                  onClick={() => setShowLanguageSelector(true)}\n                  className=\"sidebar-action-btn\"\n                >\n                  ðŸŒ {currentLanguage.nativeName}\n                </button>\n                <button \n                  onClick={() => setShowSettings(true)}\n                  className=\"sidebar-action-btn\"\n                >\n                  âš™ï¸ {t('settings')}\n                </button>\n                <button \n                  onClick={handleLogout}\n                  className=\"sidebar-action-btn logout\"\n                >\n                  {t('logout')}\n                </button>\n              </div>\n            </div>\n          </div>\n\n          {/* Main Chat Area */}\n          <div className=\"main-chat\">\n            {/* Chat Header */}\n            <div className=\"chat-header\">\n              <div className=\"chat-header-content\">\n                <h1>{t('pediatricAIAssistant')}</h1>\n                <p>{t('askMeAboutHealth')}</p>\n              </div>\n              \n              <div className=\"chat-header-actions\">\n                <button \n                  onClick={() => setShowPrescriptionForm(!showPrescriptionForm)}\n                  className={`header-action-btn ${showPrescriptionForm ? 'active' : ''}`}\n                >\n                  {t('prescriptionAnalysis')}\n                </button>\n              </div>\n            </div>\n\n            {/* Prescription Form */}\n            {showPrescriptionForm && (\n              <div className=\"prescription-form\">\n                <h3>{t('prescriptionAnalysis')}</h3>\n                <div className=\"prescription-inputs\">\n                  <div className=\"input-group\">\n                    <label>{t('patientAge')}</label>\n                    <input\n                      type=\"text\"\n                      value={patientAge}\n                      onChange={(e) => setPatientAge(e.target.value)}\n                      placeholder={t('patientAgePlaceholder')}\n                    />\n                  </div>\n                  <div className=\"input-group\">\n                    <label>{t('medicalConditions')}</label>\n                    <input\n                      type=\"text\"\n                      value={patientConditions}\n                      onChange={(e) => setPatientConditions(e.target.value)}\n                      placeholder={t('medicalConditionsPlaceholder')}\n                    />\n                  </div>\n                </div>\n                <div className=\"prescription-actions\">\n                  <input\n                    type=\"file\"\n                    ref={fileInputRef}\n                    onChange={handleImageSelect}\n                    accept=\"image/*\"\n                    style={{ display: 'none' }}\n                  />\n                  <button \n                    onClick={() => fileInputRef.current?.click()}\n                    className=\"upload-btn\"\n                  >\n                    {t('uploadPrescription')}\n                  </button>\n                  {selectedImage && (\n                    <button \n                      onClick={analyzePrescription}\n                      disabled={isPrescriptionLoading}\n                      className=\"analyze-btn\"\n                    >\n                      {isPrescriptionLoading ? t('analyzing') : t('analyzePrescription')}\n                    </button>\n                  )}\n                </div>\n                {selectedImage && (\n                  <div className=\"selected-image\">\n                    <img \n                      src={URL.createObjectURL(selectedImage)} \n                      alt=\"Selected\" \n                      className=\"preview-image\"\n                    />\n                    <button \n                      onClick={removeSelectedImage}\n                      className=\"remove-btn\"\n                    >\n                      âœ•\n                    </button>\n                  </div>\n                )}\n              </div>\n            )}\n\n            {/* Messages */}\n            <div className=\"messages-container\">\n              {messages.length === 0 ? (\n                <div className=\"empty-state\">\n                  <div className=\"empty-state-icon\">ðŸ‘¨â€âš•ï¸</div>\n                  <h2>{t('welcome')}</h2>\n                  <p>{t('emptyStateMessage')}</p>\n                </div>\n              ) : (\n                messages.map((message) => (\n                  <div key={message.id} className={`message ${message.isUser ? 'user' : 'ai'}`}>\n                    <div className=\"message-avatar\">\n                      {message.isUser ? 'ðŸ‘¤' : 'ðŸ‘¨â€âš•ï¸'}\n                    </div>\n                    <div className=\"message-content\">\n                      {message.isUser ? (\n                        <div className=\"user-message\">\n                          {message.text}\n                        </div>\n                      ) : (\n                        <div className=\"ai-message\">\n                          <ReactMarkdown \n                            components={{\n                              h1: ({node, children, ...props}) => <h1 style={{fontSize: '1.2em', margin: '8px 0'}} {...props}>{children}</h1>,\n                              h2: ({node, children, ...props}) => <h2 style={{fontSize: '1.1em', margin: '8px 0'}} {...props}>{children}</h2>,\n                              h3: ({node, children, ...props}) => <h3 style={{fontSize: '1em', margin: '6px 0'}} {...props}>{children}</h3>,\n                              p: ({node, ...props}) => <p style={{margin: '4px 0'}} {...props} />,\n                              ul: ({node, ...props}) => <ul style={{margin: '8px 0', paddingLeft: '20px'}} {...props} />,\n                              ol: ({node, ...props}) => <ol style={{margin: '8px 0', paddingLeft: '20px'}} {...props} />,\n                              li: ({node, ...props}) => <li style={{margin: '2px 0'}} {...props} />,\n                              strong: ({node, ...props}) => <strong style={{fontWeight: 'bold'}} {...props} />,\n                              em: ({node, ...props}) => <em style={{fontStyle: 'italic'}} {...props} />,\n                              blockquote: ({node, ...props}) => (\n                                <blockquote style={{\n                                  borderLeft: '3px solid #667eea',\n                                  paddingLeft: '12px',\n                                  margin: '8px 0',\n                                  fontStyle: 'italic'\n                                }} {...props} />\n                              ),\n                              code: ({node, ...props}) => (\n                                <code style={{\n                                  backgroundColor: 'rgba(102, 126, 234, 0.1)',\n                                  padding: '2px 4px',\n                                  borderRadius: '3px',\n                                  fontFamily: 'monospace'\n                                }} {...props} />\n                              )\n                            }}\n                          >\n                            {message.text}\n                          </ReactMarkdown>\n                        </div>\n                      )}\n                      {message.image && (\n                        <img \n                          src={message.image} \n                          alt=\"Uploaded\" \n                          className=\"message-image\"\n                        />\n                      )}\n                    </div>\n                  </div>\n                ))\n              )}\n              {isLoading && (\n                <div className=\"message ai\">\n                  <div className=\"message-avatar\">ðŸ‘¨â€âš•ï¸</div>\n                  <div className=\"message-content\">\n                    <div className=\"ai-message\">\n                      <div className=\"typing-indicator\">\n                        <span></span>\n                        <span></span>\n                        <span></span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              )}\n              {isPrescriptionLoading && (\n                <div className=\"message ai\">\n                  <div className=\"message-avatar\">ðŸ‘¨â€âš•ï¸</div>\n                  <div className=\"message-content\">\n                    <div className=\"ai-message\">\n                      <div className=\"typing-indicator\">\n                        <span></span>\n                        <span></span>\n                        <span></span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              )}\n            </div>\n\n            {/* Input Area */}\n            <div className=\"input-container\">\n              <div className=\"input-wrapper\">\n                <textarea\n                  value={inputText}\n                  onChange={(e) => setInputText(e.target.value)}\n                  onKeyPress={handleKeyPress}\n                  placeholder={t('chatPlaceholder')}\n                  className=\"text-input\"\n                  rows={1}\n                />\n                <div className=\"input-actions\">\n                  <input\n                    type=\"file\"\n                    ref={fileInputRef}\n                    onChange={handleImageSelect}\n                    accept=\"image/*\"\n                    style={{ display: 'none' }}\n                  />\n                  <button \n                    onClick={() => fileInputRef.current?.click()}\n                    className=\"upload-btn\"\n                    type=\"button\"\n                  >\n                    ðŸ“·\n                  </button>\n                  <button \n                    onClick={sendMessage}\n                    disabled={isLoading || (!inputText.trim() && !selectedImage)}\n                    className=\"send-btn\"\n                  >\n                    {t('send')}\n                  </button>\n                </div>\n              </div>\n              \n              {selectedImage && !showPrescriptionForm && (\n                <div className=\"selected-image\">\n                  <img \n                    src={URL.createObjectURL(selectedImage)} \n                    alt=\"Selected\" \n                    className=\"preview-image\"\n                  />\n                  <button onClick={removeSelectedImage} className=\"remove-image-btn\">\n                    âœ•\n                  </button>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n      \n      {/* Context Menu */}\n      {contextMenu && (\n        <div \n          className=\"context-menu\"\n          style={{\n            position: 'fixed',\n            top: contextMenu.y,\n            left: contextMenu.x,\n            zIndex: 1000\n          }}\n          onClick={(e) => e.stopPropagation()}\n        >\n          <button \n            onClick={() => contextMenu.sessionId && deleteSession(contextMenu.sessionId)}\n            className=\"context-menu-item delete\"\n          >\n            ðŸ—‘ï¸ Delete Chat\n          </button>\n        </div>\n      )}\n      \n      {/* Language Selector Modal */}\n      <LanguageSelector\n        onLanguageSelect={handleLanguageSelect}\n        isVisible={showLanguageSelector}\n      />\n      \n      {/* Settings Modal */}\n              <Settings\n          isVisible={showSettings}\n          onClose={handleSettingsClose}\n          currentLanguage={currentLanguage}\n          currentEmail={user?.email || ''}\n          onEmailChange={handleEmailChange}\n          onPasswordChange={handlePasswordChange}\n          darkModePreference={darkModePreference}\n          isDarkMode={isDarkMode}\n          onDarkModeToggle={handleDarkModeToggle}\n        />\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}